#define NEURONS 10
int16_t FT[25][SQUARE_SPAN][NEURONS];
int16_t BIAS[NEURONS] = {5, 68, 103, 30, 165, 256, 100, 165, 301, 314};
int OUT_W[2*NEURONS] = {-86, 53, -74, -25, -179, -107, -77, 91, 61, 91, 90, -54, 74, 24, 178, 105, 75, -103, -60, -91};
#define OUT_B 3909

void unpack(int neuron, double base, double scale, const char *data) {
    for (int i = 0; i < 768; i++) {
        int piece = i / 64 % 6 + 1;
        int color = i / 384 ? BLACK : WHITE;
        int rank = (i / 8 % 8) * 10;
        int file = i % 8;
        FT[piece | color][rank + file][neuron] = (data[i] - ' ') * scale + base;
    }
}

#ifdef OPENBENCH
// Deterministic PRNG for openbench build consistency
uint32_t rng_32() {
    static uint64_t RNG_STATE = 0xcafef00dd15ea5e5;
    // Pcg32
    uint64_t old = RNG_STATE;
    RNG_STATE = old * 6364136223846793005ull + 0xa02bdbf7bb3c0a7ull;
    uint32_t xorshifted = ((old >> 18u) ^ old) >> 27u;
    uint32_t rot = old >> 59u;
    return (xorshifted >> rot) | (xorshifted << ((-rot) & 31));
}
uint64_t rng() {
    return (uint64_t) rng_32() << 32 | rng_32();
}
#endif

uint64_t ZOBRIST_PIECES[25][SQUARE_SPAN];
uint64_t ZOBRIST_CASTLE_RIGHTS[4];
uint64_t ZOBRIST_STM;

void init_tables() {
    // Feature Transformer
unpack(0, -63.72, 2.077, "??????????;???????????5H?F????????????????9?????.????????????????L??????????????J???????????????????????????,????????????????????????J?????????????????????????????????????????4??????????????????????????????????????????????????????????????????????????????????????????????????????9??????????????????????????????????????????8????32???????:??????????????????????????????????????????????????????????W~|q?U????IQM?????DDD3???????????9???????2:?D???????????????????????????????\\????????????????????????????????????55???????????????????????????????????????????????????????????56????35????????????????????????????????????????7???????5??????5????????bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb\\bbbbbbb?????????????????????????????????????????3' !+5???7+-6?????9????");
unpack(1, -625.4, 17.76, "EEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEBEEEEEEEEEEEEEEKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTT~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC/CCCCCC.CCCCCCCCCCCCCCCCCCCCCCC CCCCC#!CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCBCCCCCCCCCCCCCCCCC99999999999999999999999999999999999999999999999999999999999999998888888888888888888888888888888888888888888888888888888888888888................................................................CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC/.CCCC//////CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC");
unpack(2, -352.5, 4.209, "pppppppppppppnpjsppppppnpppppppkpppppppkpppppfcavppppYP ppppppppttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqtttttttptttttttttttttttttttttttttttttttttttttttttttttttttttttttthhhhhhhhhhhhhhhhhhhhhhhhc`hhhhhh^]`hhhhhZhWhhhhhYZhhhhhh]hhhhhhhtttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttt|||||||||||||||||||||||||||||||||||||||x|~||zyvuz||||utv||||||||ttttttttttttttttttttttttttttttttttttttttttwtttttttttttttttttttqtttttttttttttttttttttttttttttttttttttttttttttttttttttttptttttttttttttttttttttttttttttttttttttttttttttttttttttttttmtttttttmottttvttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttkhattttttc[tttttaZWtttt]\\VN");
unpack(3, -160.4, 5.253, "?????????????9???????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????5????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????6????????? ????F??0???????????????????????????????????????????????????????????????;?????????????????????????????????????????????????????????????????????D?????????????????????????????????????????????????????????????????I????????????????~??????????????????????????????????????????????????????????????????????????????????????????????????????????????????");
unpack(4, -327.1, 6.004, "VVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHH????????????????????????????????????????????????????????????????%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% %%%%%%%%\"%%%%%%%%%VVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVaVVV`aVVVVVVVVVYYYYYYYYYYYYYYYYYYYYYYYYWYYYYYYYYYYYYYYWYYYYYYYYYYYYYYYWYYYYYYYYccccccc\\cccccccccccccccccccccccccccccccccccccccccccccccccccccccc````````````````````````````````````````````````````````````````iiiiiiiimiiiiiiiiiiiiiiikiliiiiiiijiiiiiiiiiiiiiiiiiiiiiiiiiiiii||||||||||||||||||||||||||~|||||||||||||||||||||||||||||||||||||VVVVVVVVVdVVVcdVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV");
unpack(5, -75.68, 1.731, ">>>>>>>>>>>>>>>>>>>>>>>>>>>DEC>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>CKCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC~CCCCCCC::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::9999999?999999999999999999999999999(99999999999999999999999 9999LLLLLLLLLLLLLLLLLLLLLLLLLLB=L?BLLLL50L8LL=:0-LL?LC62/LLLL:85L13LLLL[UVLLLLLLgLLLLLLL^cLLLL[WLLLL^LLLLLL\\LLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLL\\LLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLQLLLLLLLLLLLLLLLLLLL^ecdLLLcgmgoLLLZLigi`LLV]\\__ZSLLPYYSLLLLLLLLLLLLLLLLALLLLLLLLLLLTLLXLLLXZ^`b_LLTYba]WLLRX[[VLLLUUUSSRLLLLLLLLLLLLLLLLL^eeLLLeLLLhjikccLabeeec_L[LL^][XLLLLSLQLLLLLLLLLLLLLLLLLDLLLLLLLLLLLLLLLLLLLLLLLLLLLLLdLLLLLLaLVLLLLYLLWLLSLLRLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLL>LLLLLLLLLLLLLLLLLLLLLLLLLLL");
unpack(6, -390.4, 4.82, "nnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnfnnnnn\"X nnnnnnnnnnnnnqqqqqqqqqqqqqqqqqqqqqqoqqqqqqqqqqqqqqqqjqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqmqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqhqqqqqqqqqqqqqqqqqqqqqqqeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeaeeeeee_]eeeeeeYUeeeeeeeeqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxoxvxxxxxottvxxxxnspxxxyxxxxxxxxxqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqmqqoqqqqqqqqqqqqqqqqqqqqqqqqvqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqsqqqqqqqqqqqqq~~qzqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqlqqqqqqqjqqrqqqmlqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqjqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqbgqqqqqq]dfhqqqq[^_cqqsqPW[bqqqq");
unpack(7, -124.4, 2.634, "TTTTTTTT~bTTTTTTfTTTTTTT[TTTTTTTTTTTTT[TTTT]TZe^TTTTcTg\\TTTTTTTTOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOd^^^^^^^^^^^^^^^^^^^^^^^il^^^^^^^^^^^^^^^^^^^^^^^^^^^W^^^^^^^^^^YYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYOOOOOOFBOOWOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOO8 <OOOOO'*<OOOOO6AIOOOOOFIOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWOOOOOOOOOFOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOFOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOO");
unpack(8, -130.4, 1.849, "gggggggggggggggggggggggggggglgggggglgggg]gggggggggggggggggggggggqqqqq^^RXbqlqqq_qqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggxgggggg~gggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggbgggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggg                                                          602   gggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggngggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggg");
unpack(9, 0.0, 1.0, "                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                ");

    // Zobrist keys
#ifdef OPENBENCH
    for (int i = 0; i < 23; i++) {
        for (int j = 0; j < SQUARE_SPAN; j++) {
            ZOBRIST_PIECES[i][j] = rng();
        }
    }
    ZOBRIST_CASTLE_RIGHTS[0] = rng();
    ZOBRIST_CASTLE_RIGHTS[1] = rng();
    ZOBRIST_CASTLE_RIGHTS[2] = rng();
    ZOBRIST_CASTLE_RIGHTS[3] = rng();
    ZOBRIST_STM = rng();
#else
    auto rng = fopen("/dev/random", "r");
    fread(ZOBRIST_PIECES, sizeof(ZOBRIST_PIECES), 1, rng);
    fread(ZOBRIST_CASTLE_RIGHTS, sizeof(ZOBRIST_CASTLE_RIGHTS), 1, rng);
    fread(&ZOBRIST_STM, sizeof(ZOBRIST_STM), 1, rng);
#endif
}
